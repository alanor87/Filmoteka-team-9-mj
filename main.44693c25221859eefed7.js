(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"/JAH":function(e,t){var n=document.querySelector("#theme-switch-toggle"),a="light-theme",o="dark-theme";n.addEventListener("change",(function(){var e=localStorage.getItem("theme")===a?o:a;document.body.className=e,localStorage.setItem("theme",e)})),localStorage.getItem("theme")?(document.body.className=localStorage.getItem("theme"),n.checked=localStorage.getItem("theme")!==a):localStorage.setItem("theme",a)},OSpC:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("/YXa"),n("lmye"),n("JBxO"),n("FdtR"),n("WoWj"),n("U00V"),n("OSpC");var a={searchInput:document.querySelector(".search-input"),moviesCardsGallery:document.querySelector(".movie__list"),movieInfoModal:document.querySelector(".modal-movie"),loadWatchedBtn:document.querySelector("[data-modal-watched]"),loadQueueBtn:document.querySelector("[data-modal-queue]"),addWatchedBtn:document.querySelector("[data-add-watched]"),addQueueBtn:document.querySelector("[data-add-queue]"),spinnerWrap:document.querySelector(".spinner-wrap")},o=(n("IvQZ"),n("h8BN")),l=n.n(o),i=n("pKAy"),r=n.n(i),c="e25e680121e89083bb4ba7c0772c65fc",s=[],d=[],u=function(){function e(){this.page=1,this.searchQuery=""}var t=e.prototype;return t.movieAdapter=function(e){var t=e.poster_path,n=e.original_title,a=e.original_name,o=e.vote_average,l=e.vote_count,i=e.release_date,r=e.first_air_date,c=e.popularity,s=e.id,d=e.genres,u=e.overview;return{imgSrc:this.generatePosterPath(t),title:n||a,rating:o,totalVotes:l,releaseDate:i||r,id:s,popularity:c,genres:d,overview:u}},t.generatePosterPath=function(e){return"https://themoviedb.org/t/p/w220_and_h330_face"+e},t.fetchMovieByID=function(e){return fetch("https://api.themoviedb.org/3/movie/"+e+"?api_key="+c).then((function(e){if("404"===e.status)throw new Error;return e.json()}))},t.fetchSearchMoviesList=function(e){return fetch("https://api.themoviedb.org/3/search/movie?api_key="+c+"&query="+e).then((function(e){return e.json()}))},t.fetchPopularMoviesList=function(){var e=this;return fetch("https://api.themoviedb.org/3/trending/all/day?api_key="+c+"&page="+this.page).then((function(e){return e.json()})).then((function(t){return e.incrementPage(),t}))},t.fetchModalMovie=function(e){return fetch("https://api.themoviedb.org/3/movie/"+e+"?api_key="+c).then((function(e){return e.json()}))},t.fetchWatchedMovies=function(){if(0!==s.length)return Promise.resolve(s)},t.fetchQueueMovies=function(){if(0!==d.length)return Promise.resolve(d)},t.loadWatchedMoviesList=function(){if(localStorage.watched){var e=localStorage.getItem("watched");console.log(e),s.push.apply(s,JSON.parse(e))}else console.log("nothing is watched")},t.loadQueueMoviesList=function(){if(localStorage.queue){var e=localStorage.getItem("queue");console.log(e),d.push.apply(d,JSON.parse(e))}else console.log("nothing is queued")},t.addWatchedMovies=function(e){var t=e.target.dataset.movieId;s.includes(t)||s.push(t),localStorage.setItem("watched",JSON.stringify(s)),console.log(s)},t.addQueueMovies=function(e){var t=e.target.dataset.movieId;d.includes(t)||d.push(t),localStorage.setItem("queue",JSON.stringify(d)),console.log(d)},t.renderMovieCards=function(e){a.spinnerWrap.classList.add("is-hidden"),a.moviesCardsGallery.insertAdjacentHTML("beforeend",l()(e))},t.renderSingleMovie=function(e){var t=r()(e);console.log(t),a.movieInfoModal.insertAdjacentHTML("afterbegin",t)},t.incrementPage=function(){this.page+=1},t.resetPage=function(){this.page=1},e}(),m=(n("zrP5"),n("QJ3N").error),v=n("QJ3N").defaults;v.closer=!1,v.sticker=!1,v.delay=2e3,v.shadow=!0;n("/JAH");var p=n("Ji62");Object(p.addBackToTop)({diameter:56,backgroundColor:"#ddd",textColor:"#ff6b08"});n("eXOY");var h=n("jffb"),f=new u;function g(){a.movieInfoModal.classList.toggle("is-hidden"),document.querySelector("[data-add-watched]").removeEventListener("click",f.addWatchedMovies),document.querySelector("[data-add-queue]").removeEventListener("click",f.addQueueMovies),window.removeEventListener("keydown",y),a.movieInfoModal.innerHTML=""}function y(e){"Escape"===e.code&&g()}function b(){L(),f.resetPage(),f.fetchPopularMoviesList().then((function(e){return S(e)}))}function w(e){if(e.preventDefault(),L(),a.spinnerWrap.classList.remove("is-hidden"),f.resetPage(),f.searchQuery=e.target.value,console.log("Api.searchQuery:",f.searchQuery),!f.searchQuery)return b();f.fetchSearchMoviesList(f.searchQuery).then((function(e){if(S(e),!e.total_results)return m({text:"Please enter CORRECT query"})}))}function L(){a.moviesCardsGallery.innerHTML=""}function S(e){if("results"in e){var t=e.results.map((function(e){return f.movieAdapter(e)}));return f.renderMovieCards(t)}var n=e.map((function(e){return f.movieAdapter(e)}));return f.renderMovieCards(n)}function k(e){console.log(e);var t=f.movieAdapter(e);return f.renderSingleMovie(t)}function _(){L(),f.resetPage(),a.loadWatchedBtn.classList.add("active-btn"),a.loadQueueBtn.classList.remove("active-btn"),console.log("отрисовать просмотренные фильмы"),f.fetchWatchedMovies().then((function(e){return e.map((function(e){return f.fetchMovieByID(e)}))})).then((function(e){return Promise.all(e)})).then(S).then(console.log)}function E(){L(),f.resetPage(),a.loadWatchedBtn.classList.remove("active-btn"),a.loadQueueBtn.classList.add("active-btn"),console.log("отрисовать фильмы добавленные в очередь пользователя"),f.fetchQueueMovies().then((function(e){return e.map((function(e){return f.fetchMovieByID(e)}))})).then((function(e){return Promise.all(e)})).then(S).then(console.log)}window.addEventListener("load",(function(){f.loadQueueMoviesList(),f.loadWatchedMoviesList();var e=document.getElementsByTagName("html")[0];e.classList.contains("main-page")&&(b(),a.searchInput.addEventListener("input",h(w,500))),e.classList.contains("library-page")&&(a.loadWatchedBtn.addEventListener("click",_),a.loadQueueBtn.addEventListener("click",E),_())})),a.moviesCardsGallery.addEventListener("click",(function(e){if(e.target.classList.contains("movie-card__img")){var t=e.target.dataset.movieId;f.fetchModalMovie(t).then(k).then((function(){a.movieInfoModal.classList.toggle("is-hidden"),document.querySelector("[data-add-watched]").addEventListener("click",f.addWatchedMovies),document.querySelector("[data-add-queue]").addEventListener("click",f.addQueueMovies),document.querySelector(".modal-close-btn").addEventListener("click",g),window.addEventListener("keydown",y)}))}})),a.movieInfoModal.addEventListener("click",(function(e){e.target===e.currentTarget&&g()}))},eXOY:function(e,t){firebase.initializeApp({apiKey:"AIzaSyAx1D-g2qGeJxBdozCO3pfPZvfg5l9yeUc",authDomain:"my-project-2d288.firebaseapp.com",projectId:"my-project-2d288",storageBucket:"my-project-2d288.appspot.com",messagingSenderId:"582082591029",appId:"1:582082591029:web:64d668bc5f471d6b8eb47c",measurementId:"G-NMM570TBES"});var n=document.querySelector(".lightbox"),a=document.querySelector('button[data-action="login-lightbox"]'),o=document.querySelector('button[data-action="close-lightbox"]'),l=document.querySelector('button[data-action="logIn"]'),i=document.querySelector('button[data-action="logOut"]'),r=document.querySelector('button[data-action="signIn"]'),c=document.querySelector(".lightbox__overlay"),s=firebase.auth();function d(e){e.preventDefault(),n.classList.remove("is-open"),window.removeEventListener("keydown",f)}a.addEventListener("click",(function(e){e.preventDefault(),n.classList.add("is-open"),window.addEventListener("keydown",f)})),o.addEventListener("click",d),c.addEventListener("click",(function(e){e.preventDefault(),e.target===e.currentTarget&&d(e)})),l.addEventListener("click",(function(){var e=document.getElementById("email_field"),t=document.getElementById("password_field");s.signInWithEmailAndPassword(e.value,t.value).catch((function(e){return alert(e.message)})),n.classList.remove("is-open"),alert("You are successfully logged in!")})),i.addEventListener("click",(function(){s.signOut(),n.classList.remove("is-open"),alert("Hope to see you soon")})),r.addEventListener("click",(function(){var e=document.getElementById("email"),t=document.getElementById("password");s.createUserWithEmailAndPassword(e.value,t.value).catch((function(e){return alert(e.message)})),u.classList.remove("is-open"),alert("New account is created")}));var u=document.querySelector(".lightbox_2"),m=document.querySelector('button[data-action="signup-lightbox"]'),v=document.querySelector('button[data-action="close-signup-lightbox"]'),p=document.querySelector(".lightbox__overlay_2");function h(e){e.preventDefault(),u.classList.remove("is-open"),window.removeEventListener("keydown",f)}function f(e){"Escape"===e.code&&(d(e),h(e))}m.addEventListener("click",(function(e){e.preventDefault(),u.classList.add("is-open"),window.addEventListener("keydown",f)})),v.addEventListener("click",h),p.addEventListener("click",(function(e){e.preventDefault(),e.target===e.currentTarget&&h(e)})),s.onAuthStateChanged((function(e){e?(document.getElementById("user_div").style.display="block",document.getElementById("login_div").style.display="none"):(document.getElementById("user_div").style.display="none",document.getElementById("login_div").style.display="block")}))},h8BN:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,o){var l,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c="function",s=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="movie__list-item">\r\n    <div class="movie-card__wrapper-img">\r\n        <img class="movie-card__img" src='+s(typeof(l=null!=(l=d(n,"imgSrc")||(null!=t?d(t,"imgSrc"):t))?l:r)===c?l.call(i,{name:"imgSrc",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:51}}}):l)+" alt='' data-movie-id=\""+s(typeof(l=null!=(l=d(n,"id")||(null!=t?d(t,"id"):t))?l:r)===c?l.call(i,{name:"id",hash:{},data:o,loc:{start:{line:6,column:74},end:{line:6,column:80}}}):l)+'">\r\n    </div>\r\n    <h3 class="movie-card__name">'+s(typeof(l=null!=(l=d(n,"title")||(null!=t?d(t,"title"):t))?l:r)===c?l.call(i,{name:"title",hash:{},data:o,loc:{start:{line:8,column:33},end:{line:8,column:42}}}):l)+'</h3>\r\n    <p class="movie-card__description">'+s(typeof(l=null!=(l=d(n,"releaseDate")||(null!=t?d(t,"releaseDate"):t))?l:r)===c?l.call(i,{name:"releaseDate",hash:{},data:o,loc:{start:{line:9,column:39},end:{line:9,column:54}}}):l)+'</p>\r\n    <p class="movie-card__rating">'+s(typeof(l=null!=(l=d(n,"rating")||(null!=t?d(t,"rating"):t))?l:r)===c?l.call(i,{name:"rating",hash:{},data:o,loc:{start:{line:10,column:34},end:{line:10,column:44}}}):l)+"</p>\r\n</li>\r\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,o){var l;return"\r\n"+(null!=(l=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:3,column:0},end:{line:12,column:9}}}))?l:"")},useData:!0})},pKAy:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,o){var l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span\r\n                        class="modal-movie-genre">'+e.escapeExpression(e.lambda(null!=t?l(t,"name"):t,t))+"</span>"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,o){var l,i,r=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,s="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="modal-movie-card">\r\n    <div class="movie-image-wrapper">\r\n        <img class="movie-image" src="'+d(typeof(i=null!=(i=u(n,"imgSrc")||(null!=t?u(t,"imgSrc"):t))?i:c)===s?i.call(r,{name:"imgSrc",hash:{},data:o,loc:{start:{line:3,column:38},end:{line:3,column:48}}}):i)+'" alt="'+d(typeof(i=null!=(i=u(n,"title")||(null!=t?u(t,"title"):t))?i:c)===s?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:3,column:55},end:{line:3,column:64}}}):i)+'">\r\n    </div>\r\n    <div class="movie-card-info">\r\n        <h1 class="movie-name">'+d(typeof(i=null!=(i=u(n,"title")||(null!=t?u(t,"title"):t))?i:c)===s?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:40}}}):i)+'</h1>\r\n\r\n        <div class="movie-detail-wrapper">\r\n            <div class="movie-info-field">\r\n                <span class="info-field-name">Vote/Votes</span>\r\n                <span class="info-field-value"><span class="movie-card__rating">'+d(typeof(i=null!=(i=u(n,"rating")||(null!=t?u(t,"rating"):t))?i:c)===s?i.call(r,{name:"rating",hash:{},data:o,loc:{start:{line:11,column:80},end:{line:11,column:90}}}):i)+"</span> / "+d(typeof(i=null!=(i=u(n,"totalVotes")||(null!=t?u(t,"totalVotes"):t))?i:c)===s?i.call(r,{name:"totalVotes",hash:{},data:o,loc:{start:{line:11,column:100},end:{line:11,column:114}}}):i)+'</span>\r\n            </div>\r\n            <div class="movie-info-field">\r\n                <span class="info-field-name">Popularity</span>\r\n                <span class="info-field-value">'+d(typeof(i=null!=(i=u(n,"popularity")||(null!=t?u(t,"popularity"):t))?i:c)===s?i.call(r,{name:"popularity",hash:{},data:o,loc:{start:{line:15,column:47},end:{line:15,column:61}}}):i)+'</span>\r\n            </div>\r\n            <div class="movie-info-field">\r\n                <span class="info-field-name">Original Title</span>\r\n                <span class="info-field-value title">'+d(typeof(i=null!=(i=u(n,"title")||(null!=t?u(t,"title"):t))?i:c)===s?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:19,column:53},end:{line:19,column:62}}}):i)+'</span>\r\n            </div>\r\n            <div class="movie-info-field">\r\n                <span class="info-field-name">Genre</span>\r\n                <span class="info-field-value genre">'+(null!=(l=u(n,"each").call(r,null!=t?u(t,"genres"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:23,column:53},end:{line:24,column:79}}}))?l:"")+'</span>\r\n            </div>\r\n        </div>\r\n\r\n        <h2 class="movie-about">About</h2>\r\n        <p class="movie-description">'+d(typeof(i=null!=(i=u(n,"overview")||(null!=t?u(t,"overview"):t))?i:c)===s?i.call(r,{name:"overview",hash:{},data:o,loc:{start:{line:29,column:37},end:{line:29,column:49}}}):i)+'</p>\r\n\r\n        <div class="btn-wrapper">\r\n            <button class="btn btn-details btn-active__details first-btn" type="button" data-add-watched=""\r\n                data-movie-id="'+d(typeof(i=null!=(i=u(n,"id")||(null!=t?u(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:o,loc:{start:{line:33,column:31},end:{line:33,column:37}}}):i)+'">add to watched</button>\r\n            <button class="btn btn-details" type="button" data-add-queue="" data-movie-id="'+d(typeof(i=null!=(i=u(n,"id")||(null!=t?u(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:o,loc:{start:{line:34,column:91},end:{line:34,column:97}}}):i)+'">add to queue</button>\r\n        </div>\r\n    </div>\r\n    <button class="modal-close-btn" type="button">\r\n        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">\r\n            <path d="M8 8L22 22" stroke="black" stroke-width="2" />\r\n            <path d="M8 22L22 8" stroke="black" stroke-width="2" />\r\n        </svg>\r\n    </button>\r\n</div>'},useData:!0})}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.44693c25221859eefed7.js.map